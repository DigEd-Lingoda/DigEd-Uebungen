<!DOCTYPE html>
<html lang="de" style="background: transparent !important; border: none !important;">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flip-Quiz: 8 Multiple-Choice-Karten</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    html, body, iframe { background: transparent !important; border: none !important; box-shadow: none !important; margin: 0; padding: 0; }
    body { font-family: 'Open Sans', sans-serif; padding: 20px; }
    .game-wrapper { width:100%; max-width:900px; margin:0 auto; }
    .memory-game { display:grid; grid-template-columns:repeat(2,1fr); gap:20px; margin-bottom:20px; }
    .card { 
      width:100%; 
      height:280px; 
      min-height:280px;
      perspective:1000px; 
      cursor:pointer; 
      position:relative; 
    }

    .card-inner { 
      width:100%; 
      height:100%;
      position:relative; 
      transition:transform 0.6s; 
      transform-style:preserve-3d; 
      text-align:left; 
    }
    .card.flipped .card-inner { transform:rotateY(180deg); }
    .card-front, .card-back {
      position:absolute; 
      width:100%; 
      height:100%;
      backface-visibility:hidden; 
      border-radius:8px;
      display:flex; 
      justify-content:center; 
      align-items:center;
      padding:16px; 
      box-sizing:border-box; 
      user-select:none;
    }
    .card-front { 
      background:#0000ff; 
      color:#fff; 
      font-size:22px; 
      font-weight:600; 
    }
    .card-back {
      background:#fff; 
      color:#000; 
      transform:rotateY(180deg);
      overflow-y:auto; 
      font-size:16px; 
      line-height:1.4;
      flex-direction:column; 
      align-items:flex-start;
      justify-content:flex-start;
    }
    .card.flipped:not(.mismatch):not(.matched) .card-back { border:2px solid #0000ff; }
    .card.matched .card-back { background:#ff00ff; color:#fff; border:none; }
    @keyframes shake-180 { 0%,100% { transform:rotateY(180deg) translateX(0); } 20%,60% { transform:rotateY(180deg) translateX(-10px); } 40%,80% { transform:rotateY(180deg) translateX(10px); } }
    .card.flipped.mismatch .card-back { background:#ff0000; color:#fff; border:none; }
    .card.flipped.mismatch .card-inner { animation:shake-180 0.6s; }
    #restart { display:block; margin:0 auto; padding:8px 16px; font-size:14px; background:#0000ff; color:#fff; border:none; border-radius:6px; cursor:pointer; }
    #restart:hover { opacity:0.9; }
    
    /* Success Modal Styles */
    .success-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .success-modal.show {
      display: flex;
    }
    .success-content {
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      max-width: 400px;
      width: 90%;
      animation: modalAppear 0.3s ease-out;
    }
    @keyframes modalAppear {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .success-content h2 {
      color: #00aa00;
      margin-bottom: 15px;
      font-size: 24px;
    }
    .success-content p {
      font-size: 16px;
      margin-bottom: 20px;
      color: #333;
    }
    .success-button {
      background: #00aa00;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin: 5px;
    }
    .success-button:hover {
      background: #008800;
    }
    .success-button.secondary {
      background: #0000ff;
    }
    .success-button.secondary:hover {
      background: #0000cc;
    }
    
    @media(max-width:600px){ 
      .memory-game{grid-template-columns:1fr;} 
      .game-wrapper{max-width:100%;} 
      .card { height:300px; min-height:300px; }
      .success-content {
        padding: 20px;
        margin: 10px;
      }
    }
    .question{font-weight:600; margin-bottom:0.6rem; font-size:17px;}
    .options label{display:flex; align-items:flex-start; margin:0.4rem 0; cursor:pointer; font-size:14px;}
    .option-checkbox { margin-right:0.4em; width:18px; height:18px; cursor:pointer; }
    .option-text { flex:1; }
    .check-button {
      background: #0000ff;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      margin-top: 10px;
      width: 100%;
    }
    .check-button:hover {
      background: #0000cc;
    }
    .check-button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <div class="memory-game" id="game"></div>
    <button id="restart">Noch einmal spielen!</button>
  </div>

  <!-- Success Modal -->
  <div class="success-modal" id="successModal">
    <div class="success-content">
      <h2>ðŸŽ‰ Gut gemacht!</h2>
      <p>Nun geh zurÃ¼ck in das Selbstlernmodul.</p>
      <button class="success-button" onclick="closeSuccessModal()">Verstanden</button>
      <button class="success-button secondary" onclick="restartGame()">Nochmal spielen</button>
    </div>
  </div>

  <script>
    function shuffleOptions(container) {
      const labels = Array.from(container.querySelectorAll('label'));
      const texts = labels.map(lbl => lbl.dataset.text).sort(() => Math.random() - 0.5);
      labels.forEach((lbl, idx) => {
        const text = texts[idx];
        lbl.dataset.text = text;
        lbl.querySelector('.option-text').textContent = text;
      });
    }

    const cardsData = [
      { q: 'Frage1', question: 'Was ist das Hauptziel des gelben U-Hefts?', opts: ['die Dokumentation von Geburtsdaten', 'die frÃ¼hzeitige Einschulung des Kindes', 'die systematische Vorsorgeuntersuchung und FrÃ¼herkennung von AuffÃ¤lligkeiten', 'der Nachweis Ã¤rztlicher Leistungen fÃ¼r die Krankenkasse'], correct: 'die systematische Vorsorgeuntersuchung und FrÃ¼herkennung von AuffÃ¤lligkeiten' },
      { q: 'Frage2', question: 'Die J2-Untersuchung â€¦', opts: ['â€¦ ist gesetzlich vorgeschrieben.', 'â€¦ findet im Alter von 12 Jahren statt.', 'â€¦ wird von allen Krankenkassen erstattet.', 'â€¦ wird nicht von allen Krankenkassen erstattet.'], correct: 'â€¦ wird nicht von allen Krankenkassen erstattet.' },
      { q: 'Frage3', question: 'Was gehÃ¶rt NICHT zu den Zielen der U-Untersuchungen?', opts: ['frÃ¼hzeitige Erkennung von VernachlÃ¤ssigung', 'schulische Leistungsdiagnostik', 'Feststellung kÃ¶rperlicher EntwicklungsverzÃ¶gerungen', 'Diagnostik neurologischer StÃ¶rungen'], correct: 'schulische Leistungsdiagnostik' },
      { q: 'Frage4', question: 'Die Eltern erhalten das gelbe U-Heft in der Regel â€¦', opts: ['bei der Geburtsanmeldung im Rathaus', 'in der Schule', 'in der Geburtsklinik', 'beim Gesundheitsamt'], correct: 'in der Geburtsklinik' },
      { q: 'Frage5', question: 'Was bedeutet â€ževidenzbasiert" im medizinischen Kontext?', opts: ['auf Vermutungen beruhend', 'durch wissenschaftliche Studien abgesichert', 'von FachÃ¤rzten empfohlen', 'im Einzelfall unterschiedlich geregelt'], correct: 'durch wissenschaftliche Studien abgesichert' },
      { q: 'Frage6', question: 'Was versteht man unter â€žPrimÃ¤rprÃ¤vention"?', opts: ['Vorbeugung, bevor eine Krankheit entsteht', 'FrÃ¼herkennung von Krankheiten, um sie schnell zu therapieren', 'MaÃŸnahmen zur Vermeidung unnÃ¶tiger medizinischer Eingriffe', 'Rehabilitation nach einer schweren Krankheit'], correct: 'Vorbeugung, bevor eine Krankheit entsteht' },
      { q: 'Frage7', question: 'Was bedeutet â€žpsychosoziales Umfeld"?', opts: ['die medizinischen Laborwerte eines Kindes', 'die Erziehung durch Psychologen', 'die Beziehungen und Lebensbedingungen, die das seelische Wohl beeinflussen', 'Ergebnis eines Intelligenztests'], correct: 'die Beziehungen und Lebensbedingungen, die das seelische Wohl beeinflussen' },
      { q: 'Frage8', question: 'Was zeigt sich laut Studien zum Nutzen der U-Untersuchungen?', opts: ['Sie kÃ¶nnen Impfungen ersetzen.', 'Sie kÃ¶nnen Erkrankungen bei Babies und Kleinkindern vermeiden.', 'Sie fÃ¼hren zu besseren schulischen Leistungen.', 'Sie ermÃ¶glichen frÃ¼hzeitige Intervention bei EntwicklungsstÃ¶rungen.'], correct: 'Sie ermÃ¶glichen frÃ¼hzeitige Intervention bei EntwicklungsstÃ¶rungen.' }
    ];

    const game = document.getElementById('game');

    cardsData.forEach(data => {
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.q = data.q;
      card.tabIndex = 0;
      card.innerHTML = `
        <div class="card-inner">
          <div class="card-front">FRAGE</div>
          <div class="card-back">
            <div class="question">${data.question}</div>
            <div class="options">
              ${data.opts.map((o,i) => 
                `<label data-text="${o}">
                  <input type="checkbox" class="option-checkbox" />
                  <span class="option-text">${o}</span>
                </label>`
              ).join('')}
            </div>
            <button class="check-button">PrÃ¼fen</button>
          </div>
        </div>`;
      game.appendChild(card);
      shuffleOptions(card.querySelector('.options'));
    });

    function shuffleCards(){
      Array.from(game.children).sort(() => Math.random() - 0.5).forEach(c => game.appendChild(c));
    }
    
    function sortCardsChronologically(){
      Array.from(game.children)
        .sort((a, b) => {
          const numA = parseInt(a.dataset.q.replace('q', ''));
          const numB = parseInt(b.dataset.q.replace('q', ''));
          return numA - numB;
        })
        .forEach(c => game.appendChild(c));
    }
    
    // StandardmÃ¤ÃŸig chronologisch sortieren
    sortCardsChronologically();

    // Reihenfolge speichern
    const cardOrder = Array.from(game.children);

    let busy = false;

    // Success Modal Functions
    function showSuccessModal() {
      document.getElementById('successModal').classList.add('show');
    }

    function closeSuccessModal() {
      document.getElementById('successModal').classList.remove('show');
    }

    function restartGame() {
      closeSuccessModal();
      document.getElementById('restart').click();
    }

    cardOrder.forEach((card, idx) => {
      const checkboxes = card.querySelectorAll('.option-checkbox');
      const checkButton = card.querySelector('.check-button');

      card.addEventListener('click', e => {
        if (busy || card.classList.contains('matched')) return;
        if (e.target.closest('.options') || e.target.closest('.check-button')) return;
        card.classList.toggle('flipped');
      });
      card.addEventListener('keydown', e => {
        if ((e.key === 'Enter' || e.key === ' ') && !busy && !card.classList.contains('matched')) {
          if (e.target.closest('.check-button') || e.target.closest('.option-checkbox')) return;
          e.preventDefault();
          card.classList.toggle('flipped');
        }
      });

      checkButton.addEventListener('click', () => {
        if (!card.classList.contains('flipped') || busy) return;
        
        const selectedOptions = Array.from(checkboxes).filter(cb => cb.checked);
        if (selectedOptions.length === 0) return; // Keine Auswahl getroffen
        
        busy = true;
        checkButton.disabled = true;
        
        const selectedTexts = selectedOptions.map(cb => cb.closest('label').dataset.text);
        const data = cardsData.find(d => d.q === card.dataset.q);

        if (selectedTexts.length !== 1 || selectedTexts[0] !== data.correct) {
          card.classList.add('mismatch');
          setTimeout(() => {
            card.classList.remove('mismatch','flipped');
            checkboxes.forEach(cb => cb.checked = false);
            checkButton.disabled = false;
            shuffleOptions(card.querySelector('.options'));
            card.focus();
            busy = false;
          }, 1500);
        } else {
          card.classList.add('matched');
          setTimeout(() => {
            checkboxes.forEach(cb => cb.disabled = true);
            busy = false;
          }, 600);
        }
      });
    });

    document.getElementById('restart').addEventListener('click', () => {
      busy = false;
      shuffleCards();
      const newOrder = Array.from(game.children);
      cardOrder.splice(0, cardOrder.length, ...newOrder);
      cardOrder.forEach(c => {
        c.classList.remove('flipped','matched','mismatch');
        const checkboxes = c.querySelectorAll('.option-checkbox');
        const checkButton = c.querySelector('.check-button');
        shuffleOptions(c.querySelector('.options'));
        checkboxes.forEach(cb => { cb.checked = false; cb.disabled = false; });
        checkButton.disabled = false;
      });
    });
  </script>
</body>
</html>