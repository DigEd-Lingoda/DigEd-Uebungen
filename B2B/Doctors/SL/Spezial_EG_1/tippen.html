<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satz-Trainer Präzisions-Layout</title>
    <style>
        :root {
            --primary: #0000ff;
            --success: #28a745;
            --error: #dc3545;
            --bg: #f0f2f5;
        }

        /* Verhindert horizontales Scrollen und zentriert alles */
        * {
            box-sizing: border-box; /* Wichtig für die Zentrierung des Eingabefelds */
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background-color: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .game-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%; /* Nutzt verfügbaren Platz bis max-width */
            text-align: center;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .timer { color: var(--error); }
        .progress { color: var(--primary); }

        .sentence-display {
            font-size: 1.5rem;
            margin-bottom: 30px;
            line-height: 1.6;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            min-height: 100px;
            text-align: left;
            border: 1px solid #eee;
            word-wrap: break-word;
        }

        .char { color: #aaa; position: relative; }
        .correct { color: var(--success); }
        .incorrect { color: white; background-color: var(--error); border-radius: 2px; }
        .current { border-bottom: 3px solid var(--primary); color: #000; }

        /* Zentriertes Eingabefeld */
        .input-wrapper {
            width: 100%;
            display: flex;
            justify-content: center;
        }

        input {
            width: 100%; /* Durch box-sizing: border-box bleibt es exakt mittig */
            max-width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.2s;
            text-align: center; /* Tipp-Text ebenfalls zentriert für bessere Optik */
        }

        input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 8px rgba(0,0,255,0.1);
        }

        .btn-restart {
            margin-top: 25px;
            padding: 12px 30px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            display: none;
        }

        .btn-restart:hover { opacity: 0.9; }
    </style>
</head>
<body>

<div class="game-container">
    <div class="status-bar">
        <div class="progress">Satz: <span id="currentIdx">1</span> / 3</div>
        <div class="timer">Zeit: <span id="timeLeft">30</span>s</div>
    </div>
    
    <div id="sentenceDisplay" class="sentence-display"></div>
    
    <div class="input-wrapper">
        <input type="text" id="userInput" placeholder="Tippen starten..." autofocus autocomplete="off">
    </div>
    
    <button class="btn-restart" id="restartBtn" onclick="resetGame()">Neu starten</button>
</div>

<script>
    const sentences = [
        "Die Geriatrie-Station meldet, dass der Zustand des Patienten nach der Polyzytomie stabil sei.",
        "Der Patient nimmt regelmäßig, meist in der Früh, Acetylsalicylsäure zur Blutverdünnung ein.",
        "In der Sonografie zeigten sich Zysten an beiden Ovarien/Zysten, weshalb eine Biopsie der Zytologie erfolgt ist."
    ];
    
    let currentSentenceIdx = 0;
    let timer = null;
    let timeLeft = 30;
    let timerStarted = false;

    const displayEl = document.getElementById('sentenceDisplay');
    const inputEl = document.getElementById('userInput');
    const timeEl = document.getElementById('timeLeft');
    const progressEl = document.getElementById('currentIdx');
    const restartBtn = document.getElementById('restartBtn');

    function initSentence() {
        const text = sentences[currentSentenceIdx];
        displayEl.innerHTML = '';
        text.split('').forEach((char, i) => {
            const span = document.createElement('span');
            span.innerText = char;
            span.classList.add('char');
            if (i === 0) span.classList.add('current');
            displayEl.appendChild(span);
        });
        inputEl.value = '';
        inputEl.disabled = false;
        inputEl.focus();
        timeLeft = 30;
        timeEl.innerText = timeLeft;
        timerStarted = false;
        clearInterval(timer);
    }

    function startTimer() {
        timerStarted = true;
        timer = setInterval(() => {
            timeLeft--;
            timeEl.innerText = timeLeft;
            if (timeLeft <= 0) {
                clearInterval(timer);
                inputEl.disabled = true;
                alert("Zeit abgelaufen!");
                nextStep();
            }
        }, 1000);
    }

    inputEl.addEventListener('input', () => {
        if (!timerStarted && inputEl.value.length > 0) {
            startTimer();
        }

        const charSpans = displayEl.querySelectorAll('span');
        const inputValue = inputEl.value.split('');
        let isCorrect = true;

        charSpans.forEach((span, i) => {
            const char = inputValue[i];
            span.classList.remove('current');

            if (char == null) {
                span.classList.remove('correct', 'incorrect');
                if (i === inputValue.length) span.classList.add('current');
                isCorrect = false;
            } else if (char === span.innerText) {
                span.classList.add('correct');
                span.classList.remove('incorrect');
            } else {
                span.classList.add('incorrect');
                span.classList.remove('correct');
                isCorrect = false;
            }
        });

        if (isCorrect && inputValue.length === sentences[currentSentenceIdx].length) {
            clearInterval(timer);
            nextStep();
        }
    });

    function nextStep() {
        inputEl.disabled = true;
        setTimeout(() => {
            if (currentSentenceIdx < sentences.length - 1) {
                currentSentenceIdx++;
                progressEl.innerText = currentSentenceIdx + 1;
                initSentence();
            } else {
                displayEl.innerHTML = "<div style='text-align:center'><strong>Glückwunsch!</strong><br>Alle Sätze abgeschlossen.</div>";
                restartBtn.style.display = 'inline-block';
            }
        }, 800);
    }

    function resetGame() {
        currentSentenceIdx = 0;
        progressEl.innerText = "1";
        restartBtn.style.display = 'none';
        initSentence();
    }

    initSentence();
</script>

</body>
</html>